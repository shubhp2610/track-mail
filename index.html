<!DOCTYPE html>
<html>
  <head>
    <title>Parcel Sandbox</title>
    <meta charset="UTF-8" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"
    ></script>
   
  </head>

  <body>
    <button
      type="button"
      class="btn btn-primary text-right m-3"
      data-bs-toggle="modal"
      data-bs-target="#exampleModal"
    >
      Add New
    </button>
    <div id="newLink"></div>
    <!-- Modal -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">New Tracking</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label"
                  >New Id</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="myin"
                  aria-describedby="emailHelp"
                />
              </div>
            </form>
            <button
              class="btn btn-primary"
              onclick="myScript()"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              Generate
            </button>
          </div>
        </div>
      </div>
    </div>
    <div id="app"></div>

    <script>
      async function getText(file) {
  let myObject = await fetch(file);
  let myText = await myObject.text();
  let jj = JSON.parse(myText);
  let s =
    '<table class="table"><!---<thead><tr><th scope="col">ip</th><th scope="col">ip</th></tr></thead>---><tbody>';
  for (let i = 0; i < jj.length; i++) {
    s +=
      "<tr><td>" +
      jj[i].id +
      '<br><span class="time">' +
      jj[i].time +
      '</span>&nbsp;<span class="ip">' +
      jj[i].ip +
      "</span></td></tr>";
  }
  s += "</tbody></table>";
  localStorage.setItem("_fetched_data", s);
}
getText("https://track.mail.shubh.online/api/index.php");
document.getElementById("app").innerHTML = localStorage.getItem("_fetched_data");
      
      const characters =
        "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

      function generateString(length) {
        let result = "";
        const charactersLength = characters.length;
        for (let i = 0; i < length; i++) {
          result += characters.charAt(
            Math.floor(Math.random() * charactersLength)
          );
        }

        return result;
      }
      function myScript() {
        let str =
          "https://track.mail.shubh.online/api.php?id=" +
          document.getElementById("myin").value;
        let s =
          '<div class="alert alert-success" role="alert"> NEW LINK : ' +
          str +
          "&secret=" +
          generateString(5) +
          "-" +
          generateString(6) +
          "-" +
          generateString(5) +
          "</div>";
        document.getElementById("newLink").innerHTML = s;
      }
    </script>
  </body>
</html>
